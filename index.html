<!DOCTYPE html>
<html lang="zh-TW">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ¼«ç•«é¢¨æ ¼å¤©æ°£å ±å ± ğŸ’¥ (Vueç‰ˆ)</title>
    <link href="https://fonts.googleapis.com/css2?family=Bungee+Inline&family=Noto+Sans+TC:wght@700;900&display=swap"
        rel="stylesheet">
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <style>
        /* ä¿ç•™ä½ åŸæœ¬çš„æ¼«ç•«é¢¨æ ¼ CSS (ç•¥ï¼Œè«‹åƒè€ƒä½ åŸæœ¬çš„æ¨£å¼) */
        :root {
            --comic-red: #E91E63;
            --comic-blue: #03A9F4;
            --comic-yellow: #FFEB3B;
            --paper-white: #F9F9F9;
            --ink-black: #212121;
            --comic-border: 4px solid var(--ink-black);
            --comic-shadow-red: 5px 5px 0 var(--comic-red);
        }

        body {
            font-family: 'Bungee Inline', 'Noto Sans TC', sans-serif;
            background-color: var(--paper-white);
            background-image: radial-gradient(var(--ink-black) 10%, transparent 10%), radial-gradient(var(--ink-black) 10%, transparent 10%);
            background-size: 20px 20px;
            background-position: 0 0, 10px 10px;
            background-attachment: fixed;
            padding: 20px;
            display: flex;
            justify-content: center;
        }

        .weather-container {
            width: 100%;
            max-width: 900px;
            background-color: var(--comic-yellow);
            padding: 30px;
            border: var(--comic-border);
            border-radius: 15px;
            box-shadow: var(--comic-shadow-red);
            transform: rotate(-1deg);
            text-align: center;
        }

        .current-forecast {
            background-color: var(--comic-blue);
            color: white;
            padding: 25px;
            border: var(--comic-border);
            border-radius: 10px;
            box-shadow: 6px 6px 0 var(--comic-red);
            margin-bottom: 30px;
        }

        .weather-icon {
            font-size: 6em;
            animation: shake 0.5s infinite alternate;
            display: inline-block;
        }

        @keyframes shake {
            from {
                transform: rotate(0deg);
            }

            to {
                transform: rotate(-5deg);
            }
        }

        .temperature {
            font-size: 4em;
            font-weight: 900;
            color: var(--comic-yellow);
            text-shadow: 3px 3px 0 var(--ink-black);
        }

        .future-forecasts {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
        }

        .future-card {
            background: white;
            padding: 15px;
            border: var(--comic-border);
            box-shadow: 4px 4px 0 var(--comic-blue);
            border-radius: 10px;
        }
    </style>
</head>

<body>
    <div id="app" class="weather-container">
        <h1>BAM! å¤©æ°£å ±åˆ°! ğŸ’¥</h1>
        <div class="city-name">{{ cityName }} | è‹±é›„é å ±ä¸­å¿ƒ</div>

        <div v-if="loading" class="loading-spinner">è¼‰å…¥ä¸­...</div>

        <div v-else>
            <div v-if="mainForecast" class="current-forecast">
                <div class="time-header">{{ getPeriodDesc(mainForecast.startTime) }}</div>
                <div class="weather-main">
                    <span class="weather-icon">{{ getWeatherEmoji(mainForecast.weather) }}</span>
                    <div class="temperature">{{ mainForecast.maxTemp }}Â°C</div>
                </div>
                <p>{{ mainForecast.weather }} - {{ mainForecast.comfort }}</p>
                <div style="display:flex; justify-content: space-around;">
                    <span>é›¨é‡: {{ mainForecast.rain }}</span>
                    <span>ä½æº«: {{ mainForecast.minTemp }}Â°C</span>
                </div>
            </div>

            <div class="future-forecasts">
                <div v-for="f in futureForecasts" :key="f.startTime" class="future-card">
                    <div style="font-weight:900;">{{ getPeriodDesc(f.startTime).split('! ')[1] }}</div>
                    <div style="font-size:3em;">{{ getWeatherEmoji(f.weather) }}</div>
                    <div>{{ f.minTemp }}~{{ f.maxTemp }}Â°C</div>
                    <div style="font-size:0.8em;">{{ f.weather }}</div>
                </div>
            </div>
        </div>
    </div>

    <script>
        const { createApp, ref, onMounted } = Vue;
        createApp({
            setup() {
                const cityName = ref('è®€å–ä¸­...');
                const mainForecast = ref(null);
                const futureForecasts = ref([]);
                const loading = ref(true);

                const getWeatherEmoji = (text) => {
                    if (text.includes('æ™´')) return 'ğŸŒŸ';
                    if (text.includes('å¤šé›²')) return 'â˜ï¸';
                    if (text.includes('é›¨')) return 'ğŸ’¦';
                    return 'â“';
                };

                const getPeriodDesc = (timeStr) => {
                    const hour = new Date(timeStr).getHours();
                    if (hour >= 5 && hour < 12) return 'POW! æ—©æ™¨è¡Œå‹•!';
                    if (hour >= 12 && hour < 18) return 'WHAM! ä¸‹åˆå‡ºæ“Š!';
                    return 'Zzz... åŸºåœ°ä¼‘æ¯';
                };

                const fetchData = async () => {
                    try {
                        const res = await fetch('https://nutc-web-vic-peng.zeabur.app/api/weather/kaohsiung');
                        const json = await res.json();
                        cityName.value = json.data.city;
                        mainForecast.value = json.data.forecasts[0];
                        futureForecasts.value = json.data.forecasts.slice(1);
                    } catch (e) {
                        cityName.value = 'é€£ç·šå¤±æ•—';
                    } finally {
                        loading.value = false;
                    }
                };

                onMounted(fetchData);

                return { cityName, mainForecast, futureForecasts, loading, getWeatherEmoji, getPeriodDesc };
            }
        }).mount('#app');
    </script>
</body>

</html>